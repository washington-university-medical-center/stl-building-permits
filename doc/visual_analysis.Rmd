---
title: "St. Louis Building Permit Visual Analysis"
author: "Logan Williams"
date: "2/24/2020"
output: powerpoint_presentation
params:
  month: January
  pastyear: 2019
  year: 2020
  date: "2020-01-01"
  pastdate: "2019-01-01"
---

## Introduction

This notebook creates plots of each neighborhood using `ggplot`


```{r, message=FALSE, echo=FALSE}
# package loading

library(dplyr)      #data cleaning
library(here)       #file paths
library(readr)      #read csv
library(ggplot2)    #chart making
```



```{r, message=FALSE, echo=FALSE}
#load data

data <- read_csv(here("data", params$year, params$month,  "clean_data.csv"))
means <- read_csv(here("data", params$year, params$month,  "mean_data.csv"))
```


### All Neighborhoods


```{r, echo=FALSE}

# This code chunk uses ggplot to create a bar plot that displays the number of building permits per each neighborhood.

ggplot(data, aes(nbhd_name)) +
  geom_bar() +
  ggtitle("Number of Building Permits by Neighborhood") +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  ) +
  coord_flip()
```




```{r, echo=FALSE}

# This graph is a count of how many buildings have a certain number of units

ggplot(data, aes(NbrOfUnits))+
  geom_bar() +
  xlab("Units in Building") +
  ylab("Number of Buildings") +
  ggtitle("Neighborhood Building Permits") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

counts <- table(data$NbrOfUnits)
barplot(counts, main = "Neighborhood Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}

# This graph is a count of building permits by ward

counts <- table(data$Ward10)
barplot(counts, main = "Building Permits by Ward", xlab = "Ward", ylab = "Number of Building Permits")
```




```{r, echo=FALSE}

# Number of permits by neighborhood and `new_use`
# This code chunk uses the `ggplot` function to create a grouped bar chart. Included are arguments to relabel the title, legend, and x and y axes. The `stat` argument is specified as `count` because this displays the number of building permits from the variable `nbhd_name`.

ggplot(data, aes(data$nbhd_name)) +
  geom_bar(aes(fill = data$new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits by Neighborhood") +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
  xlab("Neighborhood") +
  ylab("Number of Building Permits") +
  labs(fill = "New Use") +
  coord_flip()
```




```{r, echo=FALSE, out.width= "110%", out.height= "110%"}
# Average cost by neighborhood for each `new_use`
# This code uses the `ggplot` function to create a grouped bar plot using the `means` which contains the average building permit cost by neighborhood for each `new_use`. This code also uses `scale_y_continuous` to relabel y-axis tick markers in intervals of one million (1M).

ggplot(means, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost By Neighborhood") +
  theme(plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
  ylab("Cost ($)") +
  labs(fill = "New Use") +
  coord_flip()
```


# The plot below shows a zoomed in version of the previous plot


```{r, echo=FALSE, warning=FALSE}

# Creates a plot that excludes the industrial and institutional cost from Forest Park South east as well as the commercial cost in Central West End. It uses the `scale_y_continuous` command to zoom in on the previous graph while also specifying labels on the y-axis in intervals of 50,000. 

ggplot(means, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost By Neighborhood") +
  theme(plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
  ylab("Cost ($)") +
  labs(fill = "New Use") +
  scale_y_continuous(limits = c(0, 300000))+
  coord_flip()
  
```




```{r, echo=FALSE}

# Plot Building Permits by `high_cost`

ggplot(means, aes(x = nbhd_name, y = high_cost, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Building Permits by high_cost") +
  theme(plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  coord_flip()
```


```{r, echo=FALSE}

# Plot Building Permits by `high_cost` and `low_cost`

ggplot(means, aes(x = nbhd_name, y = low_cost, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Building Permits by low_cost") +
  theme(plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  coord_flip()
```



# Individual Neighborhood Breakdown

- Number of units in each building
- Number of building permits by use
- Cost by use
- Average cost by use


# Academy


```{r, echo=FALSE}
academy <- filter(data, nbhd_name == "Academy")
counts <- table(academy$NbrOfUnits)
barplot(counts, main = "Academy Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(academy, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Academy by Use") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  ylab("Number of Permits") +
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(academy, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Academy by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
academy <- filter(means, nbhd_name == "Academy")

ggplot(academy, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Academy") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




# Central West End


```{r, echo=FALSE}
cwe <- filter(data, nbhd_name == "Central West End")
counts <- table(cwe$NbrOfUnits)
barplot(counts, main = "Central West End Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(cwe, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Central West End by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(cwe, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Central West End by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
cwe <- filter(means, nbhd_name == "Central West End")

ggplot(cwe, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Central West End") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




# DeBaliviere Place


```{r, echo=FALSE}
db_place <- filter(data, nbhd_name == "DeBaliviere Place")
counts <- table(db_place$NbrOfUnits)
barplot(counts, main = "DeBaliviere Place Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(db_place, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in DeBaliviere Place by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(db_place, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in DeBaliviere Place by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
db_place <- filter(means, nbhd_name == "DeBaliviere Place")

ggplot(db_place, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in DeBaliviere Place") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




# Forest Park South East


```{r, echo=FALSE}
frstpk_se <- filter(data, nbhd_name == "Forest Park South East")
counts <- table(frstpk_se$NbrOfUnits)
barplot(counts, main = "Forest Park South East Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(frstpk_se, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Forest Park South East by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  scale_y_continuous(breaks=c(0:9))+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(frstpk_se, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Forest Park South East by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
frstpk_se <- filter(means, nbhd_name == "Forest Park South East")

ggplot(frstpk_se, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Forest Park South East") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
```




#	Fountain Park


```{r, echo=FALSE}
ftn_prk <- filter(data, nbhd_name == "Fountain Park")
counts <- table(ftn_prk$NbrOfUnits)
barplot(counts, main = "Fountain Park Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(ftn_prk, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Fountain Park by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(ftn_prk, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Fountain Park by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
ftn_prk <- filter(means, nbhd_name == "Fountain Park")

ggplot(ftn_prk, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Fountain Park") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




#	Skinker DeBaliviere


```{r, echo=FALSE}
skinker_db <- filter(data, nbhd_name == "Skinker DeBaliviere")
counts <- table(skinker_db$NbrOfUnits)
barplot(counts, main = "Skinker DeBaliviere Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(skinker_db, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Skinker DeBaliviere by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(skinker_db, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Skinker DeBaliviere by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
skinker_db <- filter(means, nbhd_name == "Skinker DeBaliviere")

ggplot(skinker_db, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Skinker DeBaliviere") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




#	Vandeventer


```{r, echo=FALSE}
vandeventer <- filter(data, nbhd_name == "Vandeventer")
counts <- table(vandeventer$NbrOfUnits)
barplot(counts, main = "Vandeventer Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(vandeventer, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in Vandeventer by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(vandeventer, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in Vandeventer by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
vandeventer <- filter(means, nbhd_name == "Vandeventer")

ggplot(vandeventer, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in Vandeventer") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```




#	West End


```{r, echo=FALSE}
westend <- filter(data, nbhd_name == "West End")
counts <- table(westend$NbrOfUnits)
barplot(counts, main = "West End Building Permits", xlab = "Units in Building", ylab = "Number of Buildings")
```




```{r, echo=FALSE}
ggplot(westend, aes(nbhd_name)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Number of Building Permits in West End by Use") +
  ylab("Number of Building Permits") +
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )+
  labs(fill = "New Use")
```




```{r, echo=FALSE}
ggplot(westend, aes(lrgcost)) +
  geom_bar(aes(fill = new_use), position = "dodge", stat="count") +
  ggtitle("Cost of Building Permits in West End by Use") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  xlab("Cost of Permit") +
  ylab("Number of Permits") +
  labs(fill = "New Use") +
  scale_x_discrete(labels=c("FALSE" = "Less Than $50,000", "TRUE" = "Greater Than or Equal to $50,000"))
```




```{r, echo=FALSE}
westend <- filter(means, nbhd_name == "West End")

ggplot(westend, aes(x = nbhd_name, y = mean, fill = new_use)) +
  geom_bar(position = "dodge", stat="identity") +
  ggtitle("Average Building Permit Cost in West End") +
  xlab("Neighborhood") +
  ylab("Cost ($)") +
  labs(fill = "New Use")+
  theme(
    axis.title.x = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  ) 
  
```

